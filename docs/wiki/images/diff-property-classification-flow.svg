<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 340" font-family="'Segoe UI', Arial, sans-serif">
  <defs>
    <filter id="ds" x="-3%" y="-3%" width="106%" height="106%">
      <feDropShadow dx="1" dy="1" stdDeviation="1.5" flood-color="#00000018"/>
    </filter>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0,0 8,3 0,6" fill="#78909C"/>
    </marker>
  </defs>

  <!-- Start node -->
  <rect x="170" y="10" width="240" height="34" rx="17" ry="17"
        fill="#455A64" stroke="none" filter="url(#ds)"/>
  <text x="290" y="32" text-anchor="middle" font-size="12" font-weight="bold" fill="#FFFFFF">ACTIVITY_CONFIGS に登録済み？</text>

  <!-- Arrow down -->
  <line x1="290" y1="44" x2="290" y2="62" stroke="#78909C" stroke-width="1.2" marker-end="url(#arrow)"/>

  <!-- Split into No (left) and Yes (right) -->
  <!-- Horizontal bar -->
  <line x1="140" y1="68" x2="440" y2="68" stroke="#78909C" stroke-width="1"/>

  <!-- No path (left) -->
  <line x1="140" y1="68" x2="140" y2="90" stroke="#78909C" stroke-width="1.2" marker-end="url(#arrow)"/>
  <text x="128" y="84" font-size="10" fill="#78909C">No</text>

  <rect x="60" y="98" width="160" height="32" rx="6" ry="6"
        fill="#C8E6C9" stroke="#43A047" stroke-width="1" filter="url(#ds)"/>
  <text x="140" y="119" text-anchor="middle" font-size="11" font-weight="600" fill="#1B5E20">全変更をメイン表示</text>
  <text x="140" y="146" text-anchor="middle" font-size="9" fill="#78909C">（従来どおり）</text>

  <!-- Yes path (right) -->
  <line x1="440" y1="68" x2="440" y2="90" stroke="#78909C" stroke-width="1.2" marker-end="url(#arrow)"/>
  <text x="448" y="84" font-size="10" fill="#78909C">Yes</text>

  <!-- Decision: mainProperties に含まれる？ -->
  <polygon points="440,98 540,128 440,158 340,128" fill="#FFF8E1" stroke="#F9A825" stroke-width="1" filter="url(#ds)"/>
  <text x="440" y="125" text-anchor="middle" font-size="10" fill="#E65100">mainProperties</text>
  <text x="440" y="137" text-anchor="middle" font-size="10" fill="#E65100">に含まれる？</text>

  <!-- No → サブに移動 (right) -->
  <line x1="540" y1="128" x2="570" y2="128" stroke="#78909C" stroke-width="1"/>
  <text x="548" y="122" font-size="10" fill="#78909C">No</text>
  <line x1="570" y1="128" x2="570" y2="200" stroke="#78909C" stroke-width="1.2" marker-end="url(#arrow)"/>
  <rect x="520" y="208" width="100" height="32" rx="6" ry="6"
        fill="#BBDEFB" stroke="#1565C0" stroke-width="1" filter="url(#ds)"/>
  <text x="570" y="229" text-anchor="middle" font-size="11" font-weight="600" fill="#0D47A1">サブに移動</text>

  <!-- Yes → down to next decision -->
  <line x1="440" y1="158" x2="440" y2="178" stroke="#78909C" stroke-width="1.2" marker-end="url(#arrow)"/>
  <text x="448" y="172" font-size="10" fill="#78909C">Yes</text>

  <!-- Decision: 値がオブジェクト型？ -->
  <polygon points="440,180 530,206 440,232 350,206" fill="#FFF8E1" stroke="#F9A825" stroke-width="1" filter="url(#ds)"/>
  <text x="440" y="203" text-anchor="middle" font-size="10" fill="#E65100">値がオブジェクト</text>
  <text x="440" y="215" text-anchor="middle" font-size="10" fill="#E65100">型か？</text>

  <!-- Yes → サブに移動 (left) -->
  <line x1="350" y1="206" x2="310" y2="206" stroke="#78909C" stroke-width="1"/>
  <text x="316" y="200" font-size="10" fill="#78909C">Yes</text>
  <line x1="310" y1="206" x2="310" y2="246" stroke="#78909C" stroke-width="1.2" marker-end="url(#arrow)"/>
  <rect x="260" y="254" width="100" height="32" rx="6" ry="6"
        fill="#BBDEFB" stroke="#1565C0" stroke-width="1" filter="url(#ds)"/>
  <text x="310" y="275" text-anchor="middle" font-size="11" font-weight="600" fill="#0D47A1">サブに移動</text>
  <text x="310" y="300" text-anchor="middle" font-size="8" fill="#78909C">（展開すると冗長なため）</text>

  <!-- No → メイン表示 (right-down) -->
  <line x1="440" y1="232" x2="440" y2="246" stroke="#78909C" stroke-width="1.2" marker-end="url(#arrow)"/>
  <text x="448" y="243" font-size="10" fill="#78909C">No</text>
  <rect x="390" y="254" width="100" height="32" rx="6" ry="6"
        fill="#C8E6C9" stroke="#43A047" stroke-width="1" filter="url(#ds)"/>
  <text x="440" y="275" text-anchor="middle" font-size="11" font-weight="600" fill="#1B5E20">メイン表示</text>

  <!-- Result box at bottom -->
  <rect x="180" y="310" width="240" height="24" rx="6" ry="6"
        fill="#ECEFF1" stroke="#90A4AE" stroke-width="1"/>
  <text x="300" y="327" text-anchor="middle" font-size="11" font-weight="600" fill="#455A64">結果: メイン変更 / サブ変更</text>
</svg>
